<!-- âœ… Updated dashboard.html -->
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CyberGuard HIDS Logs</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-slate-300 font-sans min-h-screen p-6">

  <!-- Navbar -->
  <header class="flex flex-col md:flex-row md:items-center md:justify-between mb-8">
    <div class="mb-4 md:mb-0">
      <h1 class="text-3xl font-bold text-cyan-400">Trinetra HIDS</h1>
      <p class="text-slate-400 text-sm">Real-time Host Intrusion Logs</p>
    </div>
    <div class="flex items-center gap-4 text-sm text-slate-400">
      <button id="powerBtn" class="bg-red-500 hover:bg-red-600 text-white rounded px-3 py-1 flex items-center gap-1" onclick="startWebSocket()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 2v10m6.36-6.36a9 9 0 11-12.72 0" />
        </svg>
        Power
      </button>
      <div id="statusIndicator" class="flex items-center gap-2 bg-slate-800 px-3 py-1 rounded-md select-none">
        <div class="w-3 h-3 rounded-full bg-gray-500 animate-pulse" id="pulse"></div>
        <span class="text-gray-400 font-semibold" id="statusText">Disconnected</span>
      </div>
    </div>
  </header>

  <!-- Log Area -->
  <section class="bg-slate-800 p-4 rounded-lg shadow-lg max-h-[500px] overflow-y-auto">
    <h2 class="text-xl font-semibold text-cyan-400 mb-4">Live Logs</h2>
    <div id="log-area" class="space-y-2 text-sm text-slate-300 font-mono"></div>
  </section>

  <script>
    let ws = null;

    function startWebSocket() {
      if (ws && ws.readyState === WebSocket.OPEN) {
        console.log("WebSocket already open");
        return;
      }

      ws = new WebSocket("ws://127.0.0.1:8000/ws/attack_logs");

      ws.onopen = function () {
        console.log("WebSocket connection established");
        document.getElementById("pulse").classList.replace("bg-gray-500", "bg-green-500");
        document.getElementById("statusText").textContent = "Connected";
        document.getElementById("statusText").classList.replace("text-gray-400", "text-green-400");
      };

      ws.onmessage = function (event) {
        const logArea = document.getElementById("log-area");
        const logLine = document.createElement("div");
        logLine.classList.add("bg-slate-700", "px-3", "py-2", "rounded", "border", "border-slate-600");
        logLine.textContent = `[${new Date().toLocaleTimeString()}] ${event.data}`;
        logArea.appendChild(logLine);
        logArea.scrollTop = logArea.scrollHeight;
      };

      ws.onerror = function () {
        alert("WebSocket connection error");
        document.getElementById("pulse").classList.replace("bg-green-500", "bg-red-500");
        document.getElementById("statusText").textContent = "Error";
        document.getElementById("statusText").classList.replace("text-green-400", "text-red-400");
      };

      ws.onclose = function () {
        console.log("WebSocket connection closed");
        document.getElementById("pulse").classList.replace("bg-green-500", "bg-gray-500");
        document.getElementById("statusText").textContent = "Disconnected";
        document.getElementById("statusText").classList.replace("text-green-400", "text-gray-400");
      };
    }
  </script>

</body>
</html>
